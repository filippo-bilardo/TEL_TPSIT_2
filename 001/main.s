;==========================================================================================
; Project:  
; Date:     
; Author:   
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;
;  <inserire una breve descrizione del progetto>
;
;  <specifiche del progetto>
;  <specifiche del collaudo>
;
; Ver   Date        Comment
;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
; 1.0  01/01/01     Versione iniziale
; <Descrivere per ogni revisione o cambio di versione le modifiche apportate>
;
;==========================================================================================
		THUMB

;------------------------------------------------------------------------------------------
;=== COSTANTI =============================================================================
;------------------------------------------------------------------------------------------
GPIOB_MODER   EQU 0x48000400
GPIOB_ODR     EQU 0x48000414
GPIOE_MODER   EQU 0x48001000
GPIOE_ODR     EQU 0x48001014
RCC_CR_AHB2   EQU 0X4002104C

PB2_PORT_AHB2_BIT EQU 0x1
PB2_MODERH_BIT    EQU 0x5
PB2_MODERL_BIT    EQU 0x4
PB2_ODR_BIT       EQU 0x2

;------------------------------------------------------------------------------------------
;=== AREA ISTRUZIONI ======================================================================
;------------------------------------------------------------------------------------------
		AREA MyCode, CODE, READONLY
		ALIGN
		;------------------
		; EXPORT/IMPORT
		;------------------
		EXPORT __main
		ENTRY

;------------------------------------------------------------------------------------------
;=== MAIN ROUTINE =========================================================================
;------------------------------------------------------------------------------------------
__main
		; Inizializzazioni
		;LedRossoInit
		LDR R0,=RCC_CR_AHB2
		LDR R1,[R0]
		ORR R1,#1<<PB2_PORT_AHB2_BIT
		STR R1,[R0]
		LDR R0,=GPIOB_MODER
		LDR R1,[R0]
		BIC R1,#1<<PB2_MODERH_BIT
		ORR R1,#1<<PB2_MODERL_BIT
		STR R1,[R0]

		; Autodiagnostica
		; ----

		; Loop infinito
MainLoop
		;LedRossoToggle
		LDR R0,=GPIOB_ODR
		LDR R1,[R0]
		EOR R1,#1<<PB2_ODR_BIT
		STR R1,[R0]
		B MainLoop
;------------------------------------------------------------------------------------------
		ALIGN
		END
;------------------------------------------------------------------------------------------



